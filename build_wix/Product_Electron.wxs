<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs"
     xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui"
     xmlns:util="http://wixtoolset.org/schemas/v4/wxs/util">

  <?define Version = 0.0.0 ?>

  <Package Name="Fortuna Faucet"
           Manufacturer="Fortuna Engineering"
           Version="$(var.Version)"
           UpgradeCode="FA689549-366B-4C5C-A482-1132F9A34B10"
           Scope="perMachine"
           Compressed="yes">

    <MajorUpgrade DowngradeErrorMessage="A newer version is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Feature Id="Main">
      <ComponentGroupRef Id="AppFiles" />
      <ComponentGroupRef Id="Shortcuts" />
    </Feature>

    <ui:WixUI Id="WixUI_InstallDir" InstallDirectory="INSTALLFOLDER" />
    <WixVariable Id="WixUILicenseRtf" Value="license.rtf" />

    <?if $(var.Platform) = x64 ?>
    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="Fortuna Faucet" />
    </StandardDirectory>
    <?else?>
    <StandardDirectory Id="ProgramFilesFolder">
      <Directory Id="INSTALLFOLDER" Name="Fortuna Faucet" />
    </StandardDirectory>
    <?endif?>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="Fortuna Faucet"/>
    </StandardDirectory>

    <ComponentGroup Id="AppFiles" Directory="INSTALLFOLDER">
      <Component Id="ElectronExe" Guid="*">
        <File Source="$(var.SourceDir)\Fortuna Faucet.exe" KeyPath="yes" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="Shortcuts">
      <Component Id="StartMenuShortcut" Guid="*" Directory="ApplicationProgramsFolder">
        <Shortcut Name="Fortuna Faucet"
                  Target="[INSTALLFOLDER]Fortuna Faucet.exe" />
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
        <RegistryValue Root="HKCU"
                       Key="Software\Fortuna Faucet"
                       Name="Installed"
                       Type="integer"
                       Value="1"
                       KeyPath="yes" />
      </Component>
    </ComponentGroup>

  </Package>
</Wix>