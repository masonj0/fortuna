<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <Package Id="*"
           Name="Fortuna Faucet (Standard)"
           Language="1033"
           Version="1.0.0.0"
           Manufacturer="Fortuna Development"
           UpgradeCode="F0E1D2C3-B4A5-9687-7856-493021ABCDEF">

    <Package InstallerVersion="200"
             Compressed="yes"
             InstallScope="perMachine"
             Platform="x64" />

    <MajorUpgrade DowngradeErrorMessage="A newer version is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="Fortuna Faucet" Level="1">
      <ComponentGroupRef Id="BackendComponents" />
      <ComponentGroupRef Id="FrontendFiles" />
      <ComponentRef Id="StartMenuShortcuts" />
    </Feature>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFiles64Folder">
        <Directory Id="INSTALLFOLDER" Name="Fortuna Faucet">
          <Directory Id="BackendDirectory" Name="backend" />
          <Directory Id="UIDirectory" Name="ui" />
        </Directory>
      </Directory>
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ApplicationProgramsFolder" Name="Fortuna Faucet" />
      </Directory>
    </Directory>

    <!-- Backend Executable -->
    <ComponentGroup Id="BackendComponents" Directory="BackendDirectory">
      <Component Id="BackendExe" Guid="11111111-2222-3333-4444-555555555555" Win64="yes">
        <File Id="FortunaBackendExe"
              Source="$(var.SourceDir)\fortuna-backend.exe"
              KeyPath="yes" />
      </Component>
    </ComponentGroup>

    <!-- Start Menu Shortcuts -->
    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="StartMenuShortcuts" Guid="66666666-7777-8888-9999-000000000000" Win64="yes">
        <Shortcut Id="StartMenuShortcut"
                  Name="Fortuna Faucet"
                  Target="[BackendDirectory]fortuna-backend.exe"
                  WorkingDirectory="BackendDirectory" />
        <RemoveFolder Id="RemoveProgramsFolder" On="uninstall" />
        <RegistryValue Root="HKCU"
                       Key="Software\Fortuna"
                       Name="Installed"
                       Type="integer"
                       Value="1"
                       KeyPath="yes" />
      </Component>
    </DirectoryRef>

  </Product>
</Wix>
