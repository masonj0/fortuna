# üê¥ Fortuna Faucet - Developer's Guide

This guide provides technical instructions for developers. For end-user installation, please refer to the MSI installers generated by the project's GitHub Actions workflows.

---

## üèõÔ∏è Core Architecture

This repository contains the source code for the Fortuna Faucet application, which has two primary deployment targets:

1.  **Standalone Web Service (MSI Installer):**
    *   A Python backend powered by FastAPI, compiled into a self-contained executable using PyInstaller.
    *   A static Next.js frontend, which is bundled with the backend.
    *   The entire application is packaged into an MSI installer using the WiX Toolset, which installs the backend as a background Windows Service.

2.  **Electron Desktop Application (MSI Installer):**
    *   The same Python backend, compiled as an executable.
    *   An Electron application that acts as a wrapper, launching the backend executable and displaying the frontend.

The `python_service` and `web_service/backend` directories contain functionally equivalent but historically separate versions of the backend code. The modern workflows primarily use `web_service/backend`.

---

## üèóÔ∏è Building the Application (The Right Way)

**This project is built and packaged entirely through GitHub Actions.** The CI/CD pipelines are the single source of truth for creating production-ready installers. Manual builds are not recommended or supported due to the complexity of the environment.

The primary, production-ready build workflows are:

*   **`build-msi-hattrickfusion-ultimate.yml`**: Builds the standalone Web Service MSI. This is the most feature-rich and stable build pipeline.
*   **`build-electron-msi-gpt5.yml`**: Builds the Electron-based desktop application MSI.

These workflows handle all necessary steps, including:
*   Installing the correct versions of Python, Node.js, and the WiX Toolset.
*   Managing architecture-specific dependencies (e.g., `pandas` for x86 builds).
*   Compiling the Python backend with PyInstaller.
*   Building the static Next.js frontend.
*   Packaging the final MSI installer.
*   Running automated smoke tests to verify the installation.

To get a build, simply push a commit to the `main` branch and retrieve the MSI artifact from the completed workflow run on the [Actions tab](https://github.com/masonj0/fortuna/actions) of the repository.

---

## üî¨ Local Development Environment

### Python Version Requirement

**Crucial:** The monolith build of this project requires **Python 3.10.12**. It is not compatible with Python 3.11 or newer due to a dependency on `cefpython3`, which does not support Python 3.11.

Before running the application locally or attempting to build it, ensure you are using the correct Python version.

- **Using `pyenv` (Recommended):**
  ```bash
  pyenv install 3.10.12
  pyenv local 3.10.12
  ```

- **Using `conda`:**
  ```bash
  conda create -n fortuna python=3.10.12
  conda activate fortuna
  ```

While production builds are handled by CI/CD, the easiest way to run the application locally for development is to use the new quick-start script.

```powershell
# From the project root
./scripts/fortuna-quick-start.ps1
```

This interactive script will:
*   Check for all required dependencies (Python, Node.js, etc.).
*   Install any missing Python or Node packages automatically.
*   Clear the required network ports (8000 and 3000).
*   Launch the backend and frontend services in separate, managed terminal windows.
*   Provide a clean shutdown process.

For detailed options and first-time setup guidance, run the script with the `-Help` flag:
```powershell
./scripts/fortuna-quick-start.ps1 -Help
```

---
## üì¶ Key Tooling & Scripts

*   **`ARCHIVE_PROJECT.py`**: A utility script that scans the repository and generates the `FORTUNA_ALL_PART*.JSON` archive files. These archives are used as a ground truth for AI-driven code reviews and analysis.
*   **`AGENTS.md`**: Contains critical operational protocols for the AI agents working on this repository.
